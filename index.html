<!doctype html>
<html lang="ja">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1,user-scalable=no">
  <title>Body Condition</title>
  <style>
    html,body{margin:0;height:100%;background:#0b0d10;color:#e6e9ef;font-family:-apple-system,BlinkMacSystemFont,Segoe UI,Roboto,Helvetica,Arial,"Noto Sans JP",sans-serif}
    #app{position:fixed;inset:0;display:grid;grid-template-rows:1fr auto}
    #stage{position:relative;touch-action:none}
    canvas{display:block;width:100%;height:100%}
    #hud{display:flex;gap:.5rem;align-items:center;padding:.5rem .75rem;background:#0f1217;border-top:1px solid #1b222c;flex-wrap:wrap}
    .btn{appearance:none;border:1px solid #263043;background:#131821;color:#e6e9ef;padding:.5rem .7rem;border-radius:.6rem;font-size:.9rem}
    .btn.primary{background:#1a2a4a;border-color:#2e4d8a}
    .seg{display:flex;border:1px solid #263043;border-radius:.6rem;overflow:hidden}
    .seg button{border:0;background:#0f1217;padding:.45rem .6rem;color:#b7c0cd}
    .seg button.active{background:#1a2a4a;color:#fff}
    #lang{margin-left:auto}
    #toast{position:fixed;left:50%;transform:translateX(-50%);bottom:5.5rem;padding:.6rem .8rem;background:#111723;border:1px solid #24314a;border-radius:.6rem;display:none;z-index:10}
    #calendarPanel{position:fixed;inset:auto 0 0 0;background:#0f1217;border-top:1px solid #1b222c;transform:translateY(100%);transition:transform .25s ease;z-index:9}
    #calendarPanel.open{transform:translateY(0)}
    #calHeader{display:flex;align-items:center;justify-content:space-between;padding:.6rem .75rem;border-bottom:1px solid #1b222c}
    #calGrid{display:grid;grid-template-columns:repeat(7,1fr);gap:.25rem;padding:.5rem}
    .calCell{aspect-ratio:1/1;display:flex;align-items:center;justify-content:center;border:1px solid #1b222c;border-radius:.4rem;font-size:.9rem;color:#b7c0cd}
    .calCell.today{outline:2px solid #2e7dd7}
    .calCell.hasData{background:#132235;color:#e6f0ff}
    #help{position:fixed;top:.5rem;left:.5rem;right:.5rem;display:flex;justify-content:space-between;pointer-events:none}
    .pill{pointer-events:auto;background:rgba(16,20,28,.6);backdrop-filter:blur(6px);padding:.35rem .55rem;border:1px solid rgba(60,80,110,.5);border-radius:999px;font-size:.8rem;color:#c8d1de}

    /* ▼ ボタンが押せるように修正 ▼ */
    #hud {
      position: relative;
      z-index: 10;
      pointer-events: auto;
    }
    #stage {
      pointer-events: none;
    }
    #stage canvas {
      pointer-events: auto;
    }
    /* ▲ 追加ここまで ▲ */
  </style>
</head>
<body>
<div id="app">
  <div id="stage"></div>
  <div id="hud">
    <div class="seg" id="viewSeg"><button data-view="front" class="active">前面</button><button data-view="back">背面</button></div>
    <button class="btn" id="undoBtn">UNDO</button><button class="btn" id="redoBtn">REDO</button>
    <div class="seg"><button class="btn" id="bothBtn">左右同時</button><button class="btn" id="mirrorBtn">反対側に反映</button></div>
    <button class="btn" id="calendarBtn">カレンダー</button><button class="btn" id="shotBtn">PNG</button>
    <div class="seg"><button class="btn" id="exportBtn">JSON出力</button><button class="btn" id="importBtn">JSON取込</button></div>
    <div class="seg" id="lang"><button data-lang="ja" class="active">日本語</button><button data-lang="en">EN</button></div>
  </div>
</div>
<div id="help"><div class="pill">タップ＝強度切替（弱→中→強→オフ）</div><div class="pill">2指：ドラッグ=パン／ピンチ=ズーム</div></div>
<div id="toast"></div>
<div id="calendarPanel"><div id="calHeader">
  <button class="btn" id="calPrev">◀</button><div><div id="calTitle" style="text-align:center;font-weight:600"></div>
  <div style="text-align:center;font-size:.85rem;color:#9aa6b2">タップでその日の状態を復元</div></div><button class="btn" id="calNext">▶</button>
</div><div id="calGrid"></div></div>

<script type="module">
  import * as THREE from 'https://unpkg.com/three@0.160.1/build/three.module.js';
  import { OrbitControls } from 'https://unpkg.com/three@0.160.1/examples/jsm/controls/OrbitControls.js';

 
</script>
</body>
</html>
